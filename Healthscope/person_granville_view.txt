CREATE OR REPLACE FORCE VIEW "JULIEKER"."PERSON_GRANVILLE" ("RECORD_DEFINITION_TYPE", "RECORD_INDICATOR", "MAINTENANCE_TYPE_CODE", "MAINTENANCE_REASON_CODE", "MEMBER_UNIQUE_ID", "MEMBER_SSN", "MEMBER_LAST_NAME", "MEMBER_FIRST_NAME", "MEMBER_MIDDLE_INITIAL", "MEMBER_BIRTH_DATE", "MEMBER_GENDER_CODE", "MEMBER_MARITAL_STATUS", "MEMBER_LANGUAGE_INDICATOR", "MEMBER_EXPIRATION_DATE", "STUDENT_FLAG", "HANDICAP_FLAG", "RETIRED_FLAG", "MEMBER_EMAIL_ADDRESS", "MEMBER_STREET_1", "MEMBER_STREET_2", "MEMBER_CITY", "MEMBER_STATE_CODE", "MEMBER_ZIP_CODE", "MEMBER_COUNTRY_CODE", "MEMBER_HOME_PHONE", "MEMBER_WORK_PHONE", "MEMBER_EFFECTIVE_DATE", "MEMBER_TERMINATION_DATE", "SUBSCRIBER_UNIQUE_ID", "SUBSCRIBER_SSN_NUMBER", "SUBSCRIBER_LAST_NAME", "SUBSCRIBER_FIRST_NAME", "SUBSCRIBER_MIDDLE_INITIAL", "SUBSCRIBER_BIRTH_DATE", "SUBSCRIBER_GENDER_CODE", "MEMBER_REL_TO_SUBSCRIBER", "EMPLOYER_ID", "EMPLOYER_GROUPING_ID", "PLAN_TYPE", "BENEFIT_PLAN_NUMBER", "COORDINATION_OF_BENEFITS_FLAG", "COBRA_FLAG", "COBRA_EFFECTIVE_DATE", "COBRA_TERMINATION_DATE", "SUSPENDED_BENEFIT_FLAG", "CUSTOMERINTERNALMEMBERUNIQUEID", "ALTERNATE_PRODUCT_ID", "DUPLICATE_FLAG") AS 
  select 
RECORD_DEFINITION_TYPE              ,  
RECORD_INDICATOR                    ,  
MAINTENANCE_TYPE_CD                  , 
MAINTENANCE_REASON_CD               ,  
MEMBER_UNIQUE_ID                    , 
MEMBER_SSN                          ,  
MEMBER_LAST_NM                      , 
MEMBER_FIRST_NM                     , 
MEMBER_MIDDLE_INITIAL               ,  
MEMBER_BIRTH_DT                     ,         
MEMBER_GENDER_CD                    ,  
MEMBER_MARITAL_STATUS               ,  
MEMBER_LANGUAGE_INDICATOR           ,  
MEMBER_EXPIRATION_DT                ,         
STUDENT_FLG                         ,  
HANDICAP_FLG                        ,  
RETIRED_FLG                         ,  
MEMBER_EMAIL_ADDRESS                 , 
MEMBER_STREET_1                     , 
MEMBER_STREET_2                     , 
MEMBER_CITY                         , 
MEMBER_STATE_CD                      ,  
MEMBER_ZIP_CD                       , 
MEMBER_COUNTRY_CD                   ,  
MEMBER_HOME_PHONE                   , 
MEMBER_WORK_PHONE                   , 
MEMBER_EFFECTIVE_DT                 ,         
MEMBER_TERMINATION_DT               ,         
SUBSCRIBER_UNIQUE_ID                , 
SUBSCRIBER_SSN_NUMBER               ,  
SUBSCRIBER_LAST_NM                  , 
SUBSCRIBER_FIRST_NM                 , 
SUBSCRIBER_MIDDLE_INITIAL           ,  
SUBSCRIBER_BIRTH_DT                 , 
SUBSCRIBER_GENDER_CD                ,  
MEMBER_REL_TO_SUBSCRIBER            ,  
EMPLOYER_ID                         , 
EMPLOYER_GROUPING_ID                , 
PLAN_TYPE                           ,  
BENEFIT_PLAN_NUMBER                 , 
COORDINATION_OF_BENEFITS_FLG        ,  
COBRA_FLG                           ,  
COBRA_EFFECTIVE_DT                  ,         
COBRA_TERMINATION_DT                ,         
SUSPENDED_BENEFIT_FLG               ,  
CUSTOMERINTERNALMEMBERUNIQUEID      , 
ALTERNATE_PRODUCT_ID ,
null duplicate_flag 
from person_granville_raw where 
 to_char(update_dt,'yyyymmdd') || rowid  
 in (select max(to_char(update_dt,'yyyymmdd') || rowid)  
from person_granville_raw
group by member_unique_id, member_ssn, member_first_nm, member_last_nm);